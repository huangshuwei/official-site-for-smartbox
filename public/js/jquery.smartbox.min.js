!function(e,o,t,n){function i(o,t){console.log("初始化");var n=this;n.element=o,n.$element=e(o),n.defaults=a,n.options=e.extend({},this.defaults,t),n.ajaxOption=t?e.extend({},this.defaults.ajaxSetting,t.ajaxSetting):this.defaults.ajaxSetting,n.$header=n.$element.find(".smartBox_header"),n.$title=n.$element.find(".smartBox_header_title"),n.$body=n.$element.find(".smartBox_body"),n.$footer=n.$element.find(".smartBox_footer"),n.overlayZIndex=n.options.zIndex-1,n.$smartBoxOverlay=e('<div class="smartBoxOverlay '+n.overlayZIndex+'"></div>'),n.version="v1.0.0"}var a={type:"option",width:360,height:360,headerHeight:50,footerHeight:50,title:null,footer:null,isShowTitle:!0,isShowFooter:!0,isAutoShow:!0,zIndex:9999,content:null,ajaxSetting:{url:null,contentType:"html",type:"GET",isShowLoading:!0,loadingType:"img",loadingText:"正在加载...",errorContent:""},isShowOverlay:!0,isCloseOnOverlayClick:!0,overlayOpacity:.3,beforeClose:e.noop,isShowClose:!0,closeType:"out"};i.prototype={template:["<div>",'<div class="smartBox_header">','<span class="smartBox_header_title" />',"</div>",'<div class="smartBox_body">',"</div>",'<div class="smartBox_footer">',"</div>","</div>"].join(""),$loadingTpl:e('<div class="smartBoxLoadingText"></div>'),init:function(){console.log("init");var e=this;return e.createContainer(),e.resetValue(),e.adjustBox(),e.options.isAutoShow&&e.open(),e.$element},createContainer:function(){var o,t,n=this,i=e(n.template),a=n.options.type.toLowerCase(),s=n.options.closeType.toLowerCase();if(n.options.isShowTitle?("option"===a?o=n.options.title?n.options.title:"":"html"===a&&(o=n.$header&&n.$header.html()?n.$header.html():""),i.find(".smartBox_header_title").html(o),i.find(".smartBox_header").addClass("smartBox_header_border")):i.find(".smartBox_header_title").remove(),i.find(".smartBox_header").css({height:n.options.headerHeight+"px","line-height":n.options.headerHeight+"px"}),n.options.isShowClose){var r="in"===s?e("<a />").addClass("smartBox_header_close_normal"):e("<a />").addClass("smartBox_header_close_circle");i.find(".smartBox_header").append(r)}if("option"===a?t=n.options.content?n.options.content:"":"html"===a&&(t=n.$body&&n.$body.html()?n.$body.html():""),i.find(".smartBox_body").html(t),n.options.isShowFooter){var l="option"===a?n.options.footer:n.$footer&&n.$footer.html()?n.$footer.html():"";i.find(".smartBox_footer").html(l).css({height:n.options.footerHeight+"px",padding:"8px 15px 0 15px"})}else i.find(".smartBox_footer").remove();n.options.isShowOverlay&&(n.$smartBoxOverlay.css({"z-index":n.overlayZIndex,"z-index":n.overlayZIndex,opacity:n.options.overlayOpacity,filter:"alpha(opacity="+100*n.options.overlayOpacity+")"}),e("body").append(n.$smartBoxOverlay)),n.$element.html(i.html()).css({display:"none"}).addClass("smartBox")},resetValue:function(){var e=this;e.$header=e.$element.find(".smartBox_header"),e.$close="in"===e.options.closeType?e.$element.find(".smartBox_header_close_normal"):e.$element.find(".smartBox_header_close_circle"),e.$body=e.$element.find(".smartBox_body"),e.$footer=e.$element.find(".smartBox_footer")},adjustBox:function(){var e,o=this;o.$element.css({width:o.options.width,height:o.options.height,"z-index":o.options.zIndex}),e=o.options.height-o.$header.height(),console.log(o.$header.height()),console.log(o.$footer.height()),o.options.isShowFooter&&(e-=o.$footer.height()),o.$element.find(".smartBox_body").css({height:e}),o.$element.css({"margin-top":-(o.$element.outerHeight()/2),"margin-left":-(o.$element.outerWidth()/2)})},loadConetnt:function(){var o=this,t=o.$element.find(".smartBox_body"),n=o.ajaxOption.contentType.toLowerCase();if(t.html(""),"html"===n)e.ajax({url:o.ajaxOption.url,type:o.ajaxOption.type.toUpperCase(),dataType:"html",beforeSend:function(){o.beforeLoad()},success:function(e){t.html(e),o.loadSuccess()},error:function(){o.loadError()},complete:function(){o.afterLoad()}});else if("img"===n){var i=new Image;i.onload=function(){e(i).addClass("smartBox_body_img_center"),t.html(i).addClass("smartBox_img_center"),o.loadSuccess(),o.afterLoad()},i.onerror=function(){o.loadError(),o.afterLoad()},i.src=o.ajaxOption.url,i.complete!==!0&&o.beforeLoad()}},beforeLoad:function(){var e=this,o=e.$element.find(".smartBox_body");if(e.ajaxOption.isShowLoading)if("img"===e.ajaxOption.loadingType)o.addClass("smartBoxLoadingImg");else{var t=e.$loadingTpl.html(e.ajaxOption.loadingText);o.html(t)}},loadError:function(){var e,o=this,t=o.$element.find(".smartBox_body");o.ajaxOption.errorContent&&(e=o.$loadingTpl.html(o.ajaxOption.errorContent),t.html(e)),t.removeClass("smartBoxLoadSuccess"),o.afterLoad()},loadSuccess:function(){var e=this,o=e.$element.find(".smartBox_body");o.addClass("smartBoxLoadSuccess"),e.afterLoad()},afterLoad:function(){var e=this,o=e.$element.find(".smartBox_body");e.ajaxOption.isShowLoading&&"img"===e.ajaxOption.loadingType&&o.removeClass("smartBoxLoadingImg")},isLoadSuccess:function(){var e=this,o=e.$element.find(".smartBox_body");return o.hasClass("smartBoxLoadSuccess")},isOpened:function(){var e=this;return e.$element.is(":visible")},isClosed:function(){var e=this;return!e.$element.is(":visible")},open:function(){var e=this;e.isOpened()||("option"===e.options.type&&e.options.ajaxSetting.url&&!e.isLoadSuccess()&&(console.log("异步请求"),e.loadConetnt()),e.bindEvent(),e.options.isShowOverlay&&e.$smartBoxOverlay.show(),e.$element.show())},close:function(){var e=this;e.isClosed()||!1!==e.options.beforeClose()&&(e.options.isShowOverlay&&e.$smartBoxOverlay.hide(),e.$element.hide(),e.unbindEvent())},bindEvent:function(){var e=this;e.options.isShowClose&&e.$close.bind("click",function(){e.close()}),e.options.isCloseOnOverlayClick&&e.options.isShowOverlay&&e.$smartBoxOverlay.bind("click",function(o){e.close()})},unbindEvent:function(){var e=this;e.$close.unbind("click"),e.$smartBoxOverlay.unbind("click")}},e.fn.smartbox=function(o,t){var n="smartboxKey";return this.each(function(){var a=e(this),s=a.data(n);"string"==typeof o?s&&"function"==typeof s[o]?"close"!==o&&"open"!==o||s[o](t):s?console.error("method "+o+" does not exist on jquery.smartbox!"):console.error("you should instance jquery.smartbox before use it!"):(s=new i(this,o),s.init(),a.data(n,s))})}}(jQuery,window,document);